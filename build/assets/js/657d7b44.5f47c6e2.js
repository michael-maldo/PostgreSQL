"use strict";(globalThis.webpackChunkpostgresql=globalThis.webpackChunkpostgresql||[]).push([[2802],{108:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"basics/sql - intro","title":"sql - intro","description":"creates db, schema, sets search_path, creates and populates tables","source":"@site/docs/basics/sql - intro.md","sourceDirName":"basics","slug":"/basics/sql - intro","permalink":"/docs/basics/sql - intro","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"basics","permalink":"/docs/category/basics"},"next":{"title":"advanced","permalink":"/docs/category/advanced"}}');var a=t(4848),s=t(8453);const r={sidebar_position:1},l="sql - intro",c={},o=[{value:"initialize basicsdb database",id:"initialize-basicsdb-database",level:2},{value:"add basics schema",id:"add-basics-schema",level:2},{value:"creating a new table",id:"creating-a-new-table",level:2},{value:"populating a table with rows",id:"populating-a-table-with-rows",level:2},{value:"querying a table",id:"querying-a-table",level:2},{value:"SELECT *",id:"select-",level:3},{value:"you can write expressions",id:"you-can-write-expressions",level:3},{value:"a query can be \u201cqualified\u201d",id:"a-query-can-be-qualified",level:3},{value:"you can request that the results of a query be returned in sorted order:",id:"you-can-request-that-the-results-of-a-query-be-returned-in-sorted-order",level:3},{value:"in this example, the sort order isn&#39;t fully specified,",id:"in-this-example-the-sort-order-isnt-fully-specified",level:3},{value:"you can request that duplicate rows be removed from the result of a query",id:"you-can-request-that-duplicate-rows-be-removed-from-the-result-of-a-query",level:3},{value:"joins between tables",id:"joins-between-tables",level:2},{value:"inner join",id:"inner-join",level:3},{value:"left join",id:"left-join",level:3},{value:"right join",id:"right-join",level:3},{value:"full outer join",id:"full-outer-join",level:3},{value:"aggregate function",id:"aggregate-function",level:2},{value:"updates",id:"updates",level:2},{value:"deletions",id:"deletions",level:2},{value:"window function",id:"window-function",level:2}];function h(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"sql---intro",children:"sql - intro"})}),"\n",(0,a.jsxs)(n.p,{children:["creates db, schema, sets search_path, creates and populates tables",(0,a.jsx)("br",{}),"\nthen follows with queries, joins",(0,a.jsx)("br",{})]}),"\n",(0,a.jsx)(n.h2,{id:"initialize-basicsdb-database",children:"initialize basicsdb database"}),"\n",(0,a.jsx)(n.p,{children:"-- if db EXISTS, DROP it first"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",metastring:'title="sql"',children:"DROP DATABASE IF EXISTS basicsdb; \n\nCREATE DATABASE basicsdb;\n\\c basicsdb\n"})}),"\n",(0,a.jsx)(n.h2,{id:"add-basics-schema",children:"add basics schema"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",metastring:'title="sql"',children:"CREATE SCHEMA IF NOT EXISTS basics;\nSET search_path TO basics, public;\nshow search_path;\n"})}),"\n",(0,a.jsx)(n.h2,{id:"creating-a-new-table",children:"creating a new table"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",metastring:'title="sql"',children:"DROP TABLE IF EXISTS weather;\nCREATE TABLE IF NOT EXISTS weather (\n    city varchar(80),\n    temp_lo int,\n    temp_hi int,\n    prcp real,\n    cur_date date\n);\n\nCREATE TABLE cities (\n    name            varchar(80),\n    location        point\n);\n\n\\d weather;\n"})}),"\n",(0,a.jsx)(n.h2,{id:"populating-a-table-with-rows",children:"populating a table with rows"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",metastring:"title='sql\"",children:"INSERT INTO weather VALUES ('San Francisco', 1, 50, 0.25, '1994-11-27');\nINSERT INTO weather VALUES ('New York', 2, 50, 0.25, '1994-11-27');\nSELECT * FROM weather;\nCOPY weather FROM '/var/lib/pgsql/scripts/weather.txt';\nSELECT * FROM weather;\nCOPY weather TO '/var/lib/pgsql/scripts/weather.copy.txt';\n\n\nINSERT INTO cities VALUES ( 'San Francisco', '(-122.4194, 37.7794)');\nINSERT INTO cities VALUES ( 'New York', '(-74.0060, 40.7128)');\n\n\\echo SELECT * FROM cities;\nSELECT * FROM cities;\n\n\n\\dt basics.*\n\n\\d basics.*\n"})}),"\n",(0,a.jsx)(n.h2,{id:"querying-a-table",children:"querying a table"}),"\n",(0,a.jsx)(n.h3,{id:"select-",children:"SELECT *"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",metastring:'title="sql"',children:"\\echo SELECT * FROM weather;\nSELECT * FROM weather;\n\n\\echo SELECT city, temp_lo, temp_hi, prcp, cur_date FROM weather;\nSELECT city, temp_lo, temp_hi, prcp, cur_date FROM weather;\n"})}),"\n",(0,a.jsx)(n.h3,{id:"you-can-write-expressions",children:"you can write expressions"}),"\n",(0,a.jsx)(n.p,{children:"not just simple column references, in the SELECT list."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",metastring:'title="sql"',children:"\\echo SELECT city, (temp_hi+temp_lo)/2 AS temp_avg, cur_date FROM weather;\n\\echo\n\nSELECT city, (temp_hi+temp_lo)/2 AS temp_avg, cur_date FROM weather;\n"})}),"\n",(0,a.jsx)(n.h3,{id:"a-query-can-be-qualified",children:"a query can be \u201cqualified\u201d"}),"\n",(0,a.jsxs)(n.p,{children:["by adding a WHERE clause that specifies which rows are wanted.",(0,a.jsx)("br",{}),"\nThe WHERE clause contains a Boolean (truth value) expression, and only rows for which the Boolean expression is true are returned. The usual Boolean operators (AND, OR, and NOT) are allowed in the qualification"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",metastring:'title="sql"',children:"\\echo\n\\echo SELECT * FROM weather WHERE city = 'San Francisco' AND prcp > 0.0;\nSELECT * FROM weather WHERE city = 'San Francisco' AND prcp > 0.0;\n\nSELECT * FROM weather WHERE city NOT = 'San Francisco' ;\n"})}),"\n",(0,a.jsx)(n.h3,{id:"you-can-request-that-the-results-of-a-query-be-returned-in-sorted-order",children:"you can request that the results of a query be returned in sorted order:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",metastring:'title="sql"',children:"\\echo\n\n\\echo SELECT * FROM weather ORDER BY city;\nSELECT * FROM weather ORDER BY city;\n--SELECT * FROM weather ORDER BY city DESC;\n"})}),"\n",(0,a.jsx)(n.h3,{id:"in-this-example-the-sort-order-isnt-fully-specified",children:"in this example, the sort order isn't fully specified,"}),"\n",(0,a.jsx)(n.p,{children:"and so you might get the San Francisco rows in either order. But you'd always get the results shown above if you do"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",metastring:'title="sql"',children:"\n\\echo SELECT * FROM weather ORDER BY city, temp_lo;\nSELECT * FROM weather ORDER BY city desc, temp_lo desc;\n\n\n\\echo SELECT * FROM weather ORDER BY city desc, temp_lo desc;\nSELECT * FROM weather ORDER BY city desc, temp_lo desc;\n"})}),"\n",(0,a.jsx)(n.h3,{id:"you-can-request-that-duplicate-rows-be-removed-from-the-result-of-a-query",children:"you can request that duplicate rows be removed from the result of a query"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",metastring:'title="sql"',children:"\\echo\n\\echo SELECT DISTINCT city FROM weather;\nSELECT DISTINCT city FROM weather;\n\n\n\\echo using NOT\n\n\\echo SELECT * FROM weather WHERE city NOT IN ('San Francisco', 'New York');\nSELECT * FROM weather WHERE city NOT IN ('San Francisco', 'New York');\n"})}),"\n",(0,a.jsx)(n.h2,{id:"joins-between-tables",children:"joins between tables"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",metastring:'title="sql"',children:"\\echo SELECT * FROM weather;\nSELECT * FROM weather;\n\n\\echo SELECT * FROM cities;\nSELECT * FROM cities;\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"inner-join",children:"inner join"}),"\n",(0,a.jsxs)(n.p,{children:["return all the weather records ",(0,a.jsx)("br",{}),"\ntogether with the location of the associated city",(0,a.jsx)("br",{})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",metastring:'title="sql"',children:"\\both of these queries will produce same results\n\\ 'join' is same as 'inner joinseek'\n\\echo\n\\echo SELECT * FROM weather JOIN cities ON city = name;\nSELECT * FROM weather JOIN cities ON city = name;\n\n\\echo\n\\echo SELECT * FROM weather INNER JOIN cities ON city = name;\nSELECT * FROM weather INNER JOIN cities ON city = name;\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"left-join",children:"left join"}),"\n",(0,a.jsx)(n.h3,{id:"right-join",children:"right join"}),"\n",(0,a.jsx)(n.h3,{id:"full-outer-join",children:"full outer join"}),"\n",(0,a.jsx)(n.h2,{id:"aggregate-function",children:"aggregate function"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",metastring:'title="sql"',children:"\\echo\n\\echo Aggregate Functions\n\n\\echo SELECT * FROM weather\nSELECT * FROM weather;\n\n\n\n\\echo  -- SELECT MIN(temp_lo) FROM weather;\nSELECT MIN(temp_lo) FROM weather;\n\\echo  -- SELECT MAX(temp_lo) FROM weather;\nSELECT MAX(temp_lo) FROM weather;\n\\echo -- SELECT AVG(temp_lo) FROM weather;\nSELECT AVG(temp_lo) FROM weather;\n\n\nSELECT city FROM weather WHERE temp_lo = (SELECT max(temp_lo) FROM weather);\n\nSELECT city, count(*), max(temp_lo)\nFROM weather\nGROUP BY city;\n\nSELECT city, count(*), max(temp_lo)\nFROM weather\nGROUP BY city\nHAVING max(temp_lo) < 40;\n\nSELECT city, count(*), max(temp_lo)\nFROM weather\nWHERE city LIKE 'S%'\nGROUP BY city;\n\nSELECT city, count(*) FILTER (WHERE temp_lo < 45), max(temp_lo)\nFROM weather\nGROUP BY city;\n\n"})}),"\n",(0,a.jsx)(n.h2,{id:"updates",children:"updates"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",metastring:"title=\"sql'",children:"UPDATE weather\nSET temp_hi = temp_hi - 2,\nWHERE date > '1994-11-28';\n"})}),"\n",(0,a.jsx)(n.h2,{id:"deletions",children:"deletions"}),"\n",(0,a.jsx)(n.p,{children:"Without a qualification, DELETE will remove all rows from the given table, leaving it empty. The\nsystem will not request confirmation before doing this!"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",metastring:'title="sql"',children:"DELETE FROM weather WHERE city = 'Hayward';\n"})}),"\n",(0,a.jsx)(n.h2,{id:"window-function",children:"window function"})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>l});var i=t(6540);const a={},s=i.createContext(a);function r(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);