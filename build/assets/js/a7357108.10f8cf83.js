"use strict";(globalThis.webpackChunkpostgresql=globalThis.webpackChunkpostgresql||[]).push([[8003],{2722:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"advanced/docker","title":"Docker","description":"Perfect \u2014 let\u2019s go step by step to set up your VPS for a Dockerized Spring Boot deployment. Since you already have PostgreSQL running natively, I\u2019ll include how to connect your containerized app to that DB.","source":"@site/docs/advanced/docker.mdx","sourceDirName":"advanced","slug":"/advanced/docker","permalink":"/docs/advanced/docker","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"SQL - Advanced Features","permalink":"/docs/advanced/sql - advanced"},"next":{"title":"psql meta commands","permalink":"/docs/advanced/psql - meta commands"}}');var r=t(4848),s=t(8453);const a={sidebar_position:3},i="Docker",c={},l=[{value:"Install Docker on your VPS",id:"install-docker-on-your-vps",level:2},{value:"Create a Dockerfile for your Spring Boot app",id:"create-a-dockerfile-for-your-spring-boot-app",level:2},{value:"Build Docker image on VPS (manual test)",id:"build-docker-image-on-vps-manual-test",level:2},{value:"Connect container to your native PostgreSQL",id:"connect-container-to-your-native-postgresql",level:2},{value:"Running your container as a service (production-style)",id:"running-your-container-as-a-service-production-style",level:2},{value:"Optional: Automate deployment via GitHub Actions",id:"optional-automate-deployment-via-github-actions",level:2},{value:"This gives you full CI/CD from GitHub \u2192 VPS with Docker.",id:"this-gives-you-full-cicd-from-github--vps-with-docker",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"docker",children:"Docker"})}),"\n",(0,r.jsx)(n.p,{children:"Perfect \u2014 let\u2019s go step by step to set up your VPS for a Dockerized Spring Boot deployment. Since you already have PostgreSQL running natively, I\u2019ll include how to connect your containerized app to that DB."}),"\n",(0,r.jsx)(n.p,{children:"This will be production-ready but simple, no Kubernetes yet."}),"\n",(0,r.jsx)(n.h2,{id:"install-docker-on-your-vps",children:"Install Docker on your VPS"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-jsx",metastring:'title="bash"',children:"Assuming Ubuntu:\n# Update packages\nsudo apt update && sudo apt upgrade -y\n\n# Install Docker\nsudo apt install -y docker.io\n\n# Enable Docker to start on boot\nsudo systemctl enable docker\nsudo systemctl start docker\n\n# Add your user to the docker group\nsudo usermod -aG docker $USER\n\n"})}),"\n",(0,r.jsx)(n.p,{children:"Log out and back in so your user is in the docker group."}),"\n",(0,r.jsx)(n.p,{children:"Test installation:"}),"\n",(0,r.jsx)(n.p,{children:"docker run hello-world"}),"\n",(0,r.jsx)(n.h2,{id:"create-a-dockerfile-for-your-spring-boot-app",children:"Create a Dockerfile for your Spring Boot app"}),"\n",(0,r.jsx)(n.p,{children:"Place this in the root of your Spring Boot project:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-jsx",metastring:'title="bash"',children:'# Use Temurin Java 21 JRE as base\nFROM eclipse-temurin:21-jre\n\n# Set working directory inside container\nWORKDIR /app\n\n# Copy the Spring Boot JAR into container\nCOPY target/*.jar app.jar\n\n# Expose port 8080 (default Spring Boot)\nEXPOSE 8080\n\n# Start the application\nENTRYPOINT ["java","-jar","/app/app.jar"]\n'})}),"\n",(0,r.jsx)(n.p,{children:"This is a single-stage Docker build, simple for your VPS."}),"\n",(0,r.jsx)(n.p,{children:"Optional: Later you can make it multi-stage (build + runtime)."}),"\n",(0,r.jsx)(n.h2,{id:"build-docker-image-on-vps-manual-test",children:"Build Docker image on VPS (manual test)"}),"\n",(0,r.jsx)(n.p,{children:"From your project root:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-jsx",metastring:'title="bash"',children:"# Build Docker image\ndocker build -t myapp:latest .\n\n# Run container\ndocker run -d --name myapp \\\n-p 8080:8080 \\\n-e SPRING_DATASOURCE_URL=jdbc:postgresql://127.0.0.1:5432/mydb \\\n-e SPRING_DATASOURCE_USERNAME=appuser \\\n-e SPRING_DATASOURCE_PASSWORD=secret \\\nmyapp:latest\n\n\nCheck logs:\n\ndocker logs -f myapp\n\n\nStop / remove container:\n\ndocker stop myapp\ndocker rm myapp\n"})}),"\n",(0,r.jsx)(n.h2,{id:"connect-container-to-your-native-postgresql",children:"Connect container to your native PostgreSQL"}),"\n",(0,r.jsx)(n.p,{children:"PostgreSQL is running on 127.0.0.1 (native VPS)"}),"\n",(0,r.jsx)(n.p,{children:"Container sees VPS IP as host (by default localhost inside container \u2260 host)"}),"\n",(0,r.jsx)(n.p,{children:"Options:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-jsx",metastring:'title="bash"',children:"Use VPS private IP\n\ndocker run -d --name myapp \\\n-p 8080:8080 \\\n-e SPRING_DATASOURCE_URL=jdbc:postgresql://<VPS-IP>:5432/mydb \\\n-e SPRING_DATASOURCE_USERNAME=appuser \\\n-e SPRING_DATASOURCE_PASSWORD=secret \\\nmyapp:latest\n\n\nHost network mode (Linux only)\n\ndocker run -d --name myapp --network=host \\\n-e SPRING_DATASOURCE_URL=jdbc:postgresql://127.0.0.1:5432/mydb \\\n-e SPRING_DATASOURCE_USERNAME=appuser \\\n-e SPRING_DATASOURCE_PASSWORD=secret \\\nmyapp:latest\n"})}),"\n",(0,r.jsx)(n.p,{children:"Option 1 is safer and recommended."}),"\n",(0,r.jsx)(n.h2,{id:"running-your-container-as-a-service-production-style",children:"Running your container as a service (production-style)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-jsx",metastring:'title="bash"',children:"Using systemd:\nsudo nano /etc/systemd/system/myapp.service\n\n\nPaste:\n\n[Unit]\nDescription=My Spring Boot Docker App\nAfter=docker.service\nRequires=docker.service\n\n[Service]\nRestart=always\nExecStart=/usr/bin/docker run --rm \\\n--name myapp \\\n-p 8080:8080 \\\n-e SPRING_DATASOURCE_URL=jdbc:postgresql://<VPS-IP>:5432/mydb \\\n-e SPRING_DATASOURCE_USERNAME=appuser \\\n-e SPRING_DATASOURCE_PASSWORD=secret \\\nmyapp:latest\nExecStop=/usr/bin/docker stop myapp\n\n[Install]\nWantedBy=multi-user.target\n\n\nReload and start:\n\nsudo systemctl daemon-reload\nsudo systemctl enable myapp\nsudo systemctl start myapp\nsudo systemctl status myapp\n"})}),"\n",(0,r.jsx)(n.h2,{id:"optional-automate-deployment-via-github-actions",children:"Optional: Automate deployment via GitHub Actions"}),"\n",(0,r.jsx)(n.p,{children:"Example steps:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-jsx",metastring:'title="bash"',children:'- name: Build JAR\nrun: mvn -B package\n\n- name: Build Docker image\nrun: docker build -t myapp:latest .\n\n- name: Copy Docker image to VPS\nrun: |\ndocker save myapp:latest | bzip2 | ssh user@your-vps "bunzip2 | docker load"\n\n- name: Restart Docker container on VPS\nrun: ssh user@your-vps "sudo systemctl restart myapp"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"this-gives-you-full-cicd-from-github--vps-with-docker",children:"This gives you full CI/CD from GitHub \u2192 VPS with Docker."}),"\n",(0,r.jsx)(n.p,{children:"\u2705 TL;DR Setup Flow"}),"\n",(0,r.jsx)(n.p,{children:"Install Docker on VPS"}),"\n",(0,r.jsx)(n.p,{children:"Create Dockerfile for Spring Boot JAR"}),"\n",(0,r.jsx)(n.p,{children:"Build image locally or via CI"}),"\n",(0,r.jsx)(n.p,{children:"Run container, passing DB credentials"}),"\n",(0,r.jsx)(n.p,{children:"Use systemd to run as a service"}),"\n",(0,r.jsx)(n.p,{children:"Optionally automate with GitHub Actions"})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>i});var o=t(6540);const r={},s=o.createContext(r);function a(e){const n=o.useContext(s);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);