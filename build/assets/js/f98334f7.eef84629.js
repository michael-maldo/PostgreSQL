"use strict";(globalThis.webpackChunkpostgresql=globalThis.webpackChunkpostgresql||[]).push([[415],{1135:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>t,toc:()=>p});const t=JSON.parse('{"id":"Web/intro","title":"Intro","description":"Introduction to WEB","source":"@site/docs/Web/intro.mdx","sourceDirName":"Web","slug":"/Web/intro","permalink":"/docs/Web/intro","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"docker","permalink":"/docs/tags/docker"},{"inline":true,"label":"stop / start","permalink":"/docs/tags/stop-start"}],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Intro","description":"Introduction to WEB","tags":["docker","stop / start"]},"sidebar":"tutorialSidebar","previous":{"title":"Web","permalink":"/docs/category/web"},"next":{"title":"ssh-key","permalink":"/docs/category/ssh-key"}}');var s=r(4848),o=r(8453);const i={sidebar_position:1,title:"Intro",description:"Introduction to WEB",tags:["docker","stop / start"]},a="copy SSL certificate into container",c={},p=[];function l(e){const n={a:"a",br:"br",code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Got it \u2014 you want your Spring Boot REST API (running in Docker) to serve HTTPS instead of plain HTTP. I\u2019ll explain step by step, in a way that works for both local testing and VPS deployment."}),"\n",(0,s.jsx)(n.p,{children:"1\ufe0f\u20e3 Generate an SSL certificate"}),"\n",(0,s.jsx)(n.p,{children:"You have a few options:"}),"\n",(0,s.jsxs)(n.p,{children:["A. Self-signed (for testing)\nkeytool -genkeypair ",(0,s.jsx)(n.br,{}),"\n","-alias gnostex ",(0,s.jsx)(n.br,{}),"\n","-keyalg RSA ",(0,s.jsx)(n.br,{}),"\n","-keysize 2048 ",(0,s.jsx)(n.br,{}),"\n","-storetype PKCS12 ",(0,s.jsx)(n.br,{}),"\n","-keystore gnostex.p12 ",(0,s.jsx)(n.br,{}),"\n","-validity 3650 ",(0,s.jsx)(n.br,{}),"\n",'-dname "CN=yourdomain.com, OU=Dev, O=YourCompany, L=City, S=State, C=US" ',(0,s.jsx)(n.br,{}),"\n","-storepass changeit ",(0,s.jsx)(n.br,{}),"\n","-keypass changeit"]}),"\n",(0,s.jsx)(n.p,{children:"Generates a PKCS12 keystore (gnostex.p12) containing private key + certificate."}),"\n",(0,s.jsx)(n.p,{children:"Remember the password \u2014 you\u2019ll need it in Spring Boot."}),"\n",(0,s.jsx)(n.p,{children:"B. Production (recommended)"}),"\n",(0,s.jsx)(n.p,{children:"Use Let\u2019s Encrypt with Certbot to generate a real SSL certificate."}),"\n",(0,s.jsx)(n.p,{children:"Mount the certificate in your container (or use a reverse proxy like Nginx/Traefik)."}),"\n",(0,s.jsx)(n.p,{children:"2\ufe0f\u20e3 Configure Spring Boot for HTTPS"}),"\n",(0,s.jsx)(n.p,{children:"Add these properties to application-dev.properties (or application-prod.properties for production):"}),"\n",(0,s.jsxs)(n.p,{children:["server.port=8443\nserver.ssl.enabled=true\nserver.ssl.key-store=classpath",":gnostex",".p12\nserver.ssl.key-store-password=changeit\nserver.ssl.key-store-type=PKCS12\nserver.ssl.key-alias=gnostex"]}),"\n",(0,s.jsx)(n.p,{children:"server.port=8443 \u2192 HTTPS default port"}),"\n",(0,s.jsx)(n.p,{children:"server.ssl.key-store \u2192 path to your .p12 keystore"}),"\n",(0,s.jsx)(n.p,{children:"server.ssl.key-store-password \u2192 the password you used"}),"\n",(0,s.jsx)(n.p,{children:"server.ssl.key-alias \u2192 alias of the key in the keystore"}),"\n",(0,s.jsx)(n.p,{children:"If your keystore is outside the JAR (like in Docker), you can use file:/app/certs/gnostex.p12 instead of classpath:."}),"\n",(0,s.jsx)(n.p,{children:"3\ufe0f\u20e3 Add keystore to Docker image"}),"\n",(0,s.jsx)(n.p,{children:"Option 1: Copy into image"}),"\n",(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"copy-ssl-certificate-into-container",children:"copy SSL certificate into container"})}),"\n",(0,s.jsx)(n.p,{children:"COPY certs/gnostex.p12 /app/certs/gnostex.p12"}),"\n",(0,s.jsx)(n.p,{children:"Option 2: Mount as volume (recommended for production)"}),"\n",(0,s.jsxs)(n.p,{children:["docker run -d ",(0,s.jsx)(n.br,{}),"\n","-p 8443:8443 ",(0,s.jsx)(n.br,{}),"\n","-v /home/deploy/certs:/app/certs ",(0,s.jsx)(n.br,{}),"\n","-e SPRING_PROFILES_ACTIVE=prod ",(0,s.jsx)(n.br,{}),"\n","-e DB_URL=jdbc:postgresql://host.docker.internal:5432/gnostexdb ",(0,s.jsx)(n.br,{}),"\n","-e DB_USERNAME=gnostex ",(0,s.jsx)(n.br,{}),"\n","-e DB_PASSWORD=gnostex ",(0,s.jsx)(n.br,{}),"\n","ghcr.io/michael-maldo/gnostex-backend-api",":latest"]}),"\n",(0,s.jsxs)(n.p,{children:["4\ufe0f\u20e3 Test HTTPS locally\ncurl -k ",(0,s.jsx)(n.a,{href:"https://localhost:8443/actuator/health",children:"https://localhost:8443/actuator/health"})]}),"\n",(0,s.jsx)(n.p,{children:"-k skips verification if self-signed."}),"\n",(0,s.jsx)(n.p,{children:"If using Let\u2019s Encrypt, -k is not needed."}),"\n",(0,s.jsx)(n.p,{children:"5\ufe0f\u20e3 Optional: use a reverse proxy (production best practice)"}),"\n",(0,s.jsx)(n.p,{children:"Instead of letting Spring Boot handle SSL:"}),"\n",(0,s.jsx)(n.p,{children:"Run Spring Boot with HTTP only (server.port=8080)."}),"\n",(0,s.jsx)(n.p,{children:"Put Nginx/Traefik/HAProxy in front."}),"\n",(0,s.jsx)(n.p,{children:"Let the proxy handle SSL termination with real certificates."}),"\n",(0,s.jsx)(n.p,{children:"Advantages:"}),"\n",(0,s.jsx)(n.p,{children:"No need to rebuild Docker image for SSL changes"}),"\n",(0,s.jsx)(n.p,{children:"Easier certificate renewal (e.g., Certbot)"}),"\n",(0,s.jsx)(n.p,{children:"Supports multiple apps/domains on same VPS"}),"\n",(0,s.jsx)(n.p,{children:"\u2705 TL;DR Workflow"}),"\n",(0,s.jsx)(n.p,{children:"Generate SSL certificate (self-signed or Let\u2019s Encrypt)"}),"\n",(0,s.jsx)(n.p,{children:"Configure Spring Boot server.ssl.* properties"}),"\n",(0,s.jsx)(n.p,{children:"Copy or mount keystore into container"}),"\n",(0,s.jsx)(n.p,{children:"Expose HTTPS port (8443) in Dockerfile and docker run"}),"\n",(0,s.jsx)(n.p,{children:"Test https:// endpoint"}),"\n",(0,s.jsx)(n.p,{children:"I can make a ready-to-use Dockerfile + application.properties + docker run command that adds SSL to your backend, including healthcheck over HTTPS \u2014 fully ready for CI/CD."}),"\n",(0,s.jsx)(n.p,{children:"Do you want me to do that?"}),"\n",(0,s.jsx)(n.p,{children:"how to do this? --"}),"\n",(0,s.jsx)(n.p,{children:"use a reverse proxy (production best practice)"}),"\n",(0,s.jsx)(n.p,{children:"Instead of letting Spring Boot handle SSL:"}),"\n",(0,s.jsx)(n.p,{children:"Run Spring Boot with HTTP only (server.port=8080)."}),"\n",(0,s.jsx)(n.p,{children:"Put Nginx/Traefik/HAProxy in front."}),"\n",(0,s.jsx)(n.p,{children:"Let the proxy handle SSL termination with real certificates."}),"\n",(0,s.jsx)(n.p,{children:"Perfect \u2014 this is the production-standard approach. Let me explain step by step, in a way that will work on your VPS with Docker and GitHub Actions."}),"\n",(0,s.jsx)(n.p,{children:"1\ufe0f\u20e3 Idea: Reverse Proxy + SSL"}),"\n",(0,s.jsx)(n.p,{children:"Your Spring Boot app stays HTTP only on port 8080 inside Docker."}),"\n",(0,s.jsx)(n.p,{children:"A reverse proxy (Nginx/Traefik/HAProxy) sits in front, listens on HTTPS port 443, and:"}),"\n",(0,s.jsx)(n.p,{children:"Terminates SSL (handles HTTPS handshake)"}),"\n",(0,s.jsx)(n.p,{children:"Forwards requests to your Spring Boot app over HTTP (8080)"}),"\n",(0,s.jsx)(n.p,{children:"Can handle multiple apps/domains on the same VPS"}),"\n",(0,s.jsx)(n.p,{children:"This way:"}),"\n",(0,s.jsx)(n.p,{children:"You don\u2019t need Spring Boot to know anything about certificates."}),"\n",(0,s.jsx)(n.p,{children:"Certificates are easy to renew (Let\u2019s Encrypt)."}),"\n",(0,s.jsx)(n.p,{children:"CI/CD workflow stays simpler."}),"\n",(0,s.jsx)(n.p,{children:"2\ufe0f\u20e3 Example: Nginx Setup on VPS"}),"\n",(0,s.jsx)(n.p,{children:"Install Nginx:"}),"\n",(0,s.jsx)(n.p,{children:"sudo dnf install nginx -y   # Fedora / CentOS\nsudo systemctl enable nginx\nsudo systemctl start nginx"}),"\n",(0,s.jsx)(n.p,{children:"Obtain a certificate (Let\u2019s Encrypt):"}),"\n",(0,s.jsxs)(n.p,{children:["sudo dnf install certbot python3-certbot-nginx -y\nsudo certbot --nginx -d yourdomain.com -d ",(0,s.jsx)(n.a,{href:"http://www.yourdomain.com",children:"www.yourdomain.com"})]}),"\n",(0,s.jsx)(n.p,{children:"Certbot will automatically configure Nginx for HTTPS."}),"\n",(0,s.jsx)(n.p,{children:"Nginx reverse proxy config (simplified example):"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"server {\nlisten 80;\nserver_name yourdomain.com www.yourdomain.com;\n\n    # Redirect HTTP to HTTPS\n    return 301 https://$host$request_uri;\n}\n\nserver {\nlisten 443 ssl;\nserver_name yourdomain.com www.yourdomain.com;\n\n    ssl_certificate /etc/letsencrypt/live/yourdomain.com/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/yourdomain.com/privkey.pem;\n\n    location / {\n        proxy_pass http://localhost:8080;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Requests come to HTTPS 443 \u2192 Nginx \u2192 forwards to Spring Boot 8080"}),"\n",(0,s.jsx)(n.p,{children:"3\ufe0f\u20e3 Docker Setup"}),"\n",(0,s.jsx)(n.p,{children:"Spring Boot Docker container stays HTTP:"}),"\n",(0,s.jsxs)(n.p,{children:["docker run -d ",(0,s.jsx)(n.br,{}),"\n","--name gnostex-backend-api ",(0,s.jsx)(n.br,{}),"\n","--restart unless-stopped ",(0,s.jsx)(n.br,{}),"\n","-p 8080:8080 ",(0,s.jsx)(n.br,{}),"\n","-e SPRING_PROFILES_ACTIVE=prod ",(0,s.jsx)(n.br,{}),"\n","-e DB_URL=jdbc:postgresql://host.docker.internal:5432/gnostexdb ",(0,s.jsx)(n.br,{}),"\n","-e DB_USERNAME=gnostex ",(0,s.jsx)(n.br,{}),"\n","-e DB_PASSWORD=gnostex ",(0,s.jsx)(n.br,{}),"\n","ghcr.io/michael-maldo/gnostex-backend-api",":latest"]}),"\n",(0,s.jsx)(n.p,{children:"Nginx listens on 80/443 and proxies to the container."}),"\n",(0,s.jsx)(n.p,{children:"4\ufe0f\u20e3 Optional: Dockerized Nginx"}),"\n",(0,s.jsx)(n.p,{children:"Instead of installing Nginx on VPS host, you can run Nginx in a Docker container:"}),"\n",(0,s.jsx)(n.p,{children:'version: "3"'}),"\n",(0,s.jsxs)(n.p,{children:["services:\ngnostex-backend-api:\nimage: ghcr.io/michael-maldo/gnostex-backend-api",":latest","\ncontainer_name: gnostex-backend-api\nrestart: unless-stopped\nenvironment:\nSPRING_PROFILES_ACTIVE: prod\nDB_URL: jdbc:postgresql://host.docker.internal:5432/gnostexdb\nDB_USERNAME: gnostex\nDB_PASSWORD: gnostex\nports:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:'"8080:8080"'}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["nginx:\nimage: nginx",":latest","\ncontainer_name: nginx-proxy\nrestart: unless-stopped\nvolumes:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["./nginx.conf:/etc/nginx/conf.d/default.conf",":ro"]}),"\n",(0,s.jsxs)(n.li,{children:["/etc/letsencrypt:/etc/letsencrypt",":ro","\nports:"]}),"\n",(0,s.jsx)(n.li,{children:'"80:80"'}),"\n",(0,s.jsx)(n.li,{children:'"443:443"'}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"This way your whole stack is containerized."}),"\n",(0,s.jsx)(n.p,{children:"5\ufe0f\u20e3 Advantages of Reverse Proxy Approach\nBenefit\tExplanation\nEasier SSL\tLet\u2019s Encrypt handles it automatically\nMultiple apps\tOne Nginx can route many containers/domains\nSimpler Spring Boot\tApp doesn\u2019t need SSL certificates\nCert renewal\tAutomated via cron or Certbot\n\u2705 TL;DR"}),"\n",(0,s.jsx)(n.p,{children:"Spring Boot \u2192 HTTP only (port 8080)"}),"\n",(0,s.jsx)(n.p,{children:"Nginx/Traefik \u2192 listens HTTPS (443)"}),"\n",(0,s.jsx)(n.p,{children:"Nginx proxies traffic to Spring Boot (HTTP 8080)"}),"\n",(0,s.jsx)(n.p,{children:"Use Let\u2019s Encrypt for free SSL"}),"\n",(0,s.jsx)(n.p,{children:"Your Dockerfile stays mostly unchanged"})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>a});var t=r(6540);const s={},o=t.createContext(s);function i(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);