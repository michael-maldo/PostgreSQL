---
sidebar_position: 1
title: Intro
description: "Introduction to Docker"
tags:
- docker
- stop / start
---

# Intro

## Ops

### docker version
command to test that the client and daemon (server) are running and talking to each other
```bash  title="bash"

// this shows client is talking to the server
# highlight-next-line
$ docker version

# highlight-next-line
Client:
 Version:           24.0.5
 API version:       1.43
 Go version:        go1.22.0
 Git commit:        %{shortcommit_cli}
 Built:             Sun Feb 11 23:35:47 2024
 OS/Arch:           linux/amd64
 Context:           default

# highlight-next-line
Server:
 Engine:
  Version:          24.0.5
  API version:      1.43 (minimum version 1.12)
  Go version:       go1.22.0
  Git commit:       %{shortcommit_moby}
  Built:            Sun Feb 11 23:35:47 2024
  OS/Arch:          linux/amd64
  Experimental:     false
 containerd:
  Version:          1.6.23
  GitCommit:
 runc:
  Version:          1.3.0
  GitCommit:
 docker-init:
  Version:          0.19.0
  GitCommit:

// stopping docker - shows server not running
# highlight-next-line
$ sudo systemctl stop docker.service docker.socket containerd

# highlight-next-line
@:~$ docker version

# highlight-next-line
Client:
 Version:           24.0.5
 API version:       1.43
 Go version:        go1.22.0
 Git commit:        %{shortcommit_cli}
 Built:             Sun Feb 11 23:35:47 2024
 OS/Arch:           linux/amd64
 Context:           default
# highlight-next-line
Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?

```
### docker images
<b>Docker image</b> is like an object that contains an OS filesystem, an application, and all application dependencies.<br/>
An image gets its own <b>unique ID</b>.<br/>
When referencing images, you can refer to them using either IDs or names.
```bash title="bash"
// currently no images
# highlight-next-line
$ docker images
REPOSITORY   TAG       IMAGE ID   CREATED   SIZE

// Getting images onto your Docker host is called pulling
// sample pull of ubuntu image
# highlight-next-line
$ docker pull ubuntu:latest
latest: Pulling from library/ubuntu
20043066d3d5: Pull complete
Digest: sha256:c35e29c9450151419d9448b0fd75374fec4fff364a27f176fb458d472dfc9e54
Status: Downloaded newer image for ubuntu:latest
docker.io/library/ubuntu:latest

// docker after pull - showing ubuntu image
# highlight-next-line
$ docker images
REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
ubuntu       latest    c3a134f2ace4   2 months ago   78.1MB

```

### docker containers
<b>docker run</b> command to launch a container from the <b>ubuntu</b> image<br/>
The <b>-it</b> flags tell Docker<br/>
to make the container interactive<br/>
and to attach the current shell to the container’s terminal<br/>

```bash title="bash"
// issuing some commands inside the running ubuntu image container
# highlight-next-line
$ docker run -it ubuntu:latest /bin/bash
root@a1bb606e08be:/#
root@a1bb606e08be:/#
root@a1bb606e08be:/# hostname
a1bb606e08be
root@a1bb606e08be:/# uname -a
Linux a1bb606e08be 6.14.5-100.fc40.x86_64 #1 SMP PREEMPT_DYNAMIC Fri May  2 14:22:13 UTC 2025 x86_64 x86_64 x86_64 GNU/Linux
root@a1bb606e08be:/# date
Wed Dec 31 13:57:37 UTC 2025
root@a1bb606e08be:/# whoami
root
root@a1bb606e08be:/# ps
    PID TTY          TIME CMD
      1 pts/0    00:00:00 bash
     13 pts/0    00:00:00 ps
root@a1bb606e08be:/#

```

### Exit container without terminating
Press <b>Ctrl-PQ</b> to exit the container without terminating it. <br/>
Exit from the container without killing it. <br/>
<b>docker ps</b> command - to see all running containers <br/>

```bash title="bash"

// docker ps showing active running containers
// below showing the ubuntu image container running - 26 minutes
$ docker ps
CONTAINER ID   IMAGE           COMMAND       CREATED          STATUS          PORTS     NAMES
# highlight-next-line
a1bb606e08be   ubuntu:latest   "/bin/bash"   26 minutes ago   Up 26 minutes             youthful_vaughan

```

### Connecting to running containers

```bash title="bash"
// using CONTAINER NAME
$ docker exec -it youthful_vaughan bash
root@a1bb606e08be:/#
root@a1bb606e08be:/# read escape sequence
$

// using CONTAINER ID
$ docker exec -it a1bb606e08be bash
root@a1bb606e08be:/#
root@a1bb606e08be:/#
root@a1bb606e08be:/# read escape sequence
$
$

// using shortcut - first few characters unique part of the CONTAINER ID
// as long as it is unique
$ docker exec -it a1 bash
root@a1bb606e08be:/#
root@a1bb606e08be:/# read escape sequence
$
$

```

### Stopping / Killing running containers
Stop the container and kill it <br/>
using the <b>docker stop CONTAINER_ID | NAME</b> -- to stop a running container<br/>
and <b>docker rm CONTAINER_ID | NAME</b> command to remove a container -- only after it has stopped<br/>
substitute the names/IDs of the containers.<br/>

After container is stopped<br/>
Remove Images you want deleted<br/>
Use <b>docker rmi REPOSITORY[:TAG] | IMAGE_ID</b><br/>


```bash title="bash"
// check running containers
$ docker ps
CONTAINER ID   IMAGE           COMMAND       CREATED             STATUS             PORTS     NAMES
a1bb606e08be   ubuntu:latest   "/bin/bash"   About an hour ago   Up About an hour             youthful_vaughan
$

// unsuccessful removal of still running container
$ docker rm a1bb606e08be
Error response from daemon: You cannot remove a running container a1bb606e08bedc6a05b8696f08d7790763baa60426d7220359d5115bb860af45. Stop the container before attempting removal or force remove
$
$

// stoping a running container
$ docker stop a1bb606e08be
a1bb606e08be
$

// docker ps  -- show container removed from the list
$ docker ps
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES

// docker ps -a -- still showing container
$ docker ps -a
CONTAINER ID   IMAGE           COMMAND       CREATED             STATUS                        PORTS     NAMES
a1bb606e08be   ubuntu:latest   "/bin/bash"   About an hour ago   Exited (137) 22 seconds ago             youthful_vaughan
$

// safe - successful removal of a stopped container
$ docker rm a1bb606e08be
a1bb606e08be
$
$ docker ps -a
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
$ docker ps
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
$
$ docker images
REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
ubuntu       latest    c3a134f2ace4   2 months ago   78.1MB
$
$

// image can be removed only after the container is stopped / removed
$ docker rmi ubuntu
Untagged: ubuntu:latest
Untagged: ubuntu@sha256:c35e29c9450151419d9448b0fd75374fec4fff364a27f176fb458d472dfc9e54
Deleted: sha256:c3a134f2ace4f6d480733efcfef27c60ea8ed48be1cd36f2c17ec0729775b2c8
Deleted: sha256:e8bce0aabd687e9ee90e0bada33884f40b277196f72aac9934357472863a80ae
$


```

## Dev

### clone an app from a Git repo

```bash title="bash"

$ git clone https://github.com/nigelpoulton/psweb.git
Cloning into 'psweb'...
remote: Enumerating objects: 63, done.
remote: Counting objects: 100% (34/34), done.
remote: Compressing objects: 100% (22/22), done.
remote: Total 63 (delta 13), reused 25 (delta 9), pack-reused 29
Receiving objects: 100% (63/63), 13.29 KiB | 4.43 MiB/s, done.
Resolving deltas: 100% (21/21), done.

```


### inspect its Dockerfile

```bash title="bash"

$ cd psweb
$ ls -l
total 40
-rw-r--r--@ 1 ubuntu ubuntu
-rw-r--r--@ 1 ubuntu ubuntu
-rw-r--r--@ 1 ubuntu ubuntu
-rw-r--r-- 1 ubuntu ubuntu
-rw-r--r--@ 1 ubuntu ubuntu
drwxr-xr-x 4 ubuntu ubuntu
drwxr-xr-x 3 ubuntu ubuntu
338 24 Apr 19:29 Dockerfile
396 24 Apr 19:32 README.md
341 24 Apr 19:29 app.js
216 24 Apr 19:29 circle.yml
377 24 Apr 19:36 package.json
128 24 Apr 19:29 test
96 24 Apr 19:29 views

$ cat Dockerfile
FROM alpine
LABEL maintainer="nigelpoulton@hotmail.com"
RUN apk add --update nodejs nodejs-npm
COPY . /src
WORKDIR /src
RUN npm install
EXPOSE 8080
ENTRYPOINT ["node", "./app.js"]



```

### containerize and run as a container.

```

$ docker build -t test:latest .
[+] Building 36.2s (11/11) FINISHED
=> [internal] load .dockerignore
=> => transferring context: 2B
=> [internal] load build definition from Dockerfile
<Snip>
=> => naming to docker.io/library/test:latest
=> => unpacking to docker.io/library/test:latest
0.0s
0.0s
0.0s
0.0s
0.7s

$ docker images
REPO
TAG
test
latest
IMAGE ID
1ede254e072b
CREATED
7 seconds ago
SIZE
154MB

$ docker run -d \
--name web1 \
--publish 8080:8080 \
test:latest

```


### new commands
```
docker events  --- see docker restarts, kills, exits in real time. <br/>
docker logs -f gnostex-backend -- equivalent of tail -f logs <br/>
docker run -d --rm  --name gnostex-backend-api --add-host=host.docker.internal:host-gateway  -p 8080:8080  -e SPRING_PROFILES_ACTIVE=dev  -e DB_URL=jdbc:postgresql://host.docker.internal:5432/gnostexdb  -e DB_USERNAME=gnostex  -e DB_PASSWORD=gnostex  gnostex-backend-api <br/>
--add-host=host.docker.internal:host-gateway -- Map host.docker.internal to the Linux host<br/>
try running postgresql also as a container <br/>
docker build -t gnostex-backend-api . -- docker build <br/>
docker run -it --rm  --entrypoint sh  gnostex-backend-api  -- for exploring the image<br/>
curl -f http://localhost:8080/actuator/health

{"status":"UP","components":{"db":{"status":"UP","details":{"database":"PostgreSQL","validationQuery":"isValid()"}},"diskSpace":{"status":"UP","details":{"total":206900281344,"free":195738656768,"threshold":10485760,"path":"/app/.","exists":true}},"ping":{"status":"UP"},"ssl":{"status":"UP","details":{"validChains":[],"invalidChains":[]}}}}

docker inspect
docker inspect --format='{{.State.Health.Status}}' gnostex-backend-api
```

### retagging images
```bash title="bash"
docker images
REPOSITORY                        TAG       IMAGE ID       SIZE
gnostex-backend-api                latest    def456
gnostex-backend-api                abc123    abc123

docker tag abc123 gnostex-backend-api:latest

docker images
REPOSITORY                        TAG       IMAGE ID       SIZE
gnostex-backend-api                latest    abc123
gnostex-backend-api                def456    def456
gnostex-backend-api                abc123    abc123

// Remove old latest tag reference
docker rmi gnostex-backend-api:latest

// Tags are just labels, not copies of images.
// You can move tags freely — this is how you can roll back latest to a previous build.
// Useful for manual rollback on VPS:

docker stop gnostex-backend-api
docker rm gnostex-backend-api
docker tag abc123 gnostex-backend-api:latest
docker run -d --name gnostex-backend-api -p 8080:8080 gnostex-backend-api:latest
```



